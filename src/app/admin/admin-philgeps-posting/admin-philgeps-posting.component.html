<nav class="navbar navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand text-white">PhilGEPS Postings</a>

    <form class="d-flex" role="search" (submit)="$event.preventDefault()">
      <input
        class="form-control me-2"
        type="search"
        placeholder="Search"
        aria-label="Search"
        [(ngModel)]="searchTerm"
        name="search"
        (ngModelChange)="refresh()"
      />
      <button
        class="btn btn-success d-flex align-items-center gap-2"
        type="button"
        (click)="create()"
      >
        <i class="bi bi-plus-square"></i>
        Create
      </button>
    </form>
  </div>
</nav>

<div class="container-fluid mt-3">
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-primary">
        <tr>
          <th scope="col">Reference No.</th>
          <th scope="col">Project</th>
          <th scope="col">Date Posted</th>
          <th scope="col">Budget (ABC)</th>
          <th scope="col">Contractor / Supplier</th>
          <th scope="col">Purchase / Job Order / Contract</th>
          <th scope="col" class="text-center">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr
          *ngFor="
            let post of filteredPostings
              | slice : (page - 1) * pageSize : (page - 1) * pageSize + pageSize
          "
        >
          <td>{{ post.reference }}</td>
          <td>{{ post.project }}</td>
          <td>{{ post.createdAt | date : "MMM d, y" }}</td>
          <td>{{ post.budget | currency : "â‚±" }}</td>
          <td>{{ post.contractor }}</td>
          <td>{{ post.jobOrder }}</td>
          <td class="text-center">
            <button
              class="btn btn-sm btn-outline-primary me-1"
              (click)="edit(post)"
            >
              <i class="bi bi-pencil-square"></i>
            </button>
            <button
              class="btn btn-sm btn-outline-danger"
              (click)="delete(post)"
            >
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>

        <tr *ngIf="filteredPostings.length === 0">
          <td colspan="7" class="text-center text-muted py-3">
            No results found.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="d-flex justify-content-between align-items-center p-2 border-top">
    <ngb-pagination
      [collectionSize]="filteredPostings.length"
      [(page)]="page"
      [pageSize]="pageSize"
      [maxSize]="10"
      [rotate]="true"
      [boundaryLinks]="true"
    >
    </ngb-pagination>

    <select
      class="form-select"
      style="width: auto"
      [(ngModel)]="pageSize"
      (change)="refresh()"
    >
      <option [ngValue]="10">5 items per page</option>
      <option [ngValue]="20">10 items per page</option>
      <option [ngValue]="30">20 items per page</option>
    </select>
  </div>
</div>
